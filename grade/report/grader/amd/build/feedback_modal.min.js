define("gradereport_grader/feedback_modal",["exports","core/modal_factory","core/ajax","core/templates"],(function(_exports,_modal_factory,_ajax,_templates){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Javascript module for displaying feedback in a modal window
   *
   * @module      gradereport_grader/feedback_modal
   * @copyright   2023 Kevin Percy <kevin.percy@moodle.com>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=_exports.fetchFeedback=void 0,_modal_factory=_interopRequireDefault(_modal_factory),_ajax=_interopRequireDefault(_ajax),_templates=_interopRequireDefault(_templates);const Selectors_showFeedback='[data-action="feedback"]',Selectors_userId="tr[data-uid]",Selectors_itemId="td[data-itemid]",fetchFeedback=(userid,itemid)=>{const request={methodname:"core_grades_get_feedback",args:{userid:userid,itemid:itemid}};return _ajax.default.call([request])[0]};_exports.fetchFeedback=fetchFeedback;const registerEventListeners=()=>{document.addEventListener("click",(e=>{if(e.target.closest(Selectors_showFeedback))return e.preventDefault(),void(async(userid,itemid)=>{let feedbackData=await fetchFeedback(userid,itemid);_modal_factory.default.create({title:"Feedback",removeOnClose:!0,large:!0}).then((modal=>{let body=_templates.default.render("core_grades/feedback_modal",{feedbacktext:feedbackData.feedbacktext,user:{picture:feedbackData.picture,fullname:feedbackData.fullname,additionalfield:feedbackData.additionalfield}});return modal.setBody(body),modal.setTitle(feedbackData.title),modal.show(),modal}))})(e.target.closest(Selectors_userId).dataset.uid,e.target.closest(Selectors_itemId).dataset.itemid)}))};_exports.init=()=>{registerEventListeners()}}));

//# sourceMappingURL=feedback_modal.min.js.map